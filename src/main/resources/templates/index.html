<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{nav.brand}">Travel Agency</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>

<div th:replace="~{fragments/nav-bar :: nav-bar-fragment}"></div>

<div id="alerts-container"></div>

<div class="container-fluid mt-5 px-lg-5">
    <header class="text-center mb-5">
        <h1 class="page-title display-5 fw-bold" th:text="#{voucher.list.header}">Explore Vouchers</h1>
        <p class="text-muted fs-5" th:text="#{voucher.welcome.subtitle}">Find your perfect journey</p>
    </header>

    <div class="row g-5">
        <aside class="col-lg-3 col-xl-2">
            <div class="filter-sidebar shadow-sm border-0">
                <h5 class="mb-4 fw-bold">
                    <i class="fas fa-sliders-h me-2 text-primary"></i>
                    <span th:text="#{filter.categories}">Filters</span>
                </h5>

                <form sec:authorize="isAuthenticated()"
                      id="combined-filter"
                      hx-get="/vouchers"
                      hx-target="#voucher-list"
                      hx-trigger="change, keyup delay:500ms from:input">

                    <div id="sort-inputs-container">
                        <input type="hidden" name="sortField" value="">
                        <input type="hidden" name="sortDirection" value="">
                    </div>

                    <div th:replace="~{fragments/filter :: filter-fragment}"></div>
                </form>

                <div sec:authorize="!isAuthenticated()" class="text-center p-4 rounded-4 bg-light">
                    <i class="fas fa-lock mb-3 text-muted d-block fs-2"></i>
                    <small class="text-muted" th:text="#{filter.login_req}">Login to filter</small>
                </div>
            </div>
        </aside>

        <main class="col-lg-9 col-xl-10">
            <div id="voucher-list"
                 hx-get="/vouchers"
                 hx-trigger="load">

                <div class="table-container shadow-sm d-flex flex-column align-items-center py-5">
                    <div class="spinner-border text-primary mb-3" role="status"></div>
                    <span class="text-muted fw-medium">Searching for deals...</span>
                </div>
            </div>
        </main>
    </div>
</div>

<footer class="footer mt-5">
    <div class="container text-center">
    </div>
</footer>

<script src="https://unpkg.com/htmx.org@1.9.10"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/script.js}"></script>

</body>
</html>